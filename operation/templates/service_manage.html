<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="UTF-8">
    <title>量化运维管理系统</title>
    <meta charset="UTF-8">
    <script type="text/javascript" src="/static/js/jquery.min.js"></script>
    <script type="text/javascript" src="/static/js/jquery.easyui.min.js"></script>
    <script type="text/javascript" src="/static/js/easyui-lang-zh_CN.js"></script>
    <link rel="stylesheet" type="text/css" href="/static/css/easyui.css">
    <link rel="stylesheet" type="text/css" href="/static/css/icon.css">
    <link rel="stylesheet" type="text/css" href="/static/css/demo.css">
    <script type="text/javascript" src="/static/Scripts/service_manage.js"></script>
    <style>
        .datagrid-row-selected{
            background: #FCF6BA;
            color:#030303;
        }
        label{
            display: inline-block;
            width:70px;
            text-align: right;
        }
    </style>
</head>

<body class="easyui-layout">

    <div data-options="region:'center',title:'服务配置',iconCls:'icon-large-smartart'" style="overflow: hidden;">
        <div title="DataGrid" style="padding:2px;">
            <table id="service_table" data-options="toolbar:'#tb'" style="overflow: hidden;"></table>
        </div>
    </div>

    <!-- toolbar -->
    <div id="tb" style="padding:3px;height:auto">
        <div style="margin-bottom:1px">
                <a id="service_add" class="easyui-linkbutton" data-options="iconCls:'icon-add'" plain="true" >新增</a>
                <a id="service_edit" class="easyui-linkbutton" data-options="iconCls:'icon-edit'" plain="true">修改</a>
                <a id="service_delete" class="easyui-linkbutton" data-options="iconCls:'icon-cancel'" plain="true">删除</a>
                <input type = "text" id="check_all_server" placeholder="选择服务器"></input>
                <!-- <a id="service_check" class="easyui-linkbutton" data-options="iconCls:'icon-magnifier'" plain="true">检查</a> -->
                <a id="service_start" class="easyui-linkbutton" data-options="iconCls:'icon-ok'" plain="true">启动</a>
                <a id="service_stop" class="easyui-linkbutton" data-options="iconCls:'icon-cancel'" plain="true">停止</a>
                <a id="service_restart" class="easyui-linkbutton" data-options="iconCls:'icon-reload'" plain="true">重启</a>
        </div>
    </div>

    <div id="service" class="easyui-dialog" closed=true  style="width:400px;padding:20px 40px">
        <form id="fm" method="get">
            <p><label for="ser_id">服务编号:</label>
                <input name="ser_id" class="easyui-textbox easyui-validatebox" validType="strEngNum" style="width:200px;height:32px" required="true"></p>
            <p><label for="ser_name">服务名称:</label>
                <input name="ser_name" class="easyui-textbox easyui-validatebox" validType="strip" style="width:200px;height:32px" required="true"></p>
            <p><label for="ser_srv">所属主机:</label>
                <input id=ser_srv name="ser_srv" class="easyui-combobox" style="width:200px;height:32px" required="true"  data-options="editable:false,panelHeight:'116',valueField:'srvnum',textField:'srvnum',url:'/serverinfo_combobox_json/'"></p>
            <p><label for="ser_att">服务属性:</label>
                <input id="ser_att" name="ser_att" class="easyui-combobox" style="width:200px;height:32px" required="true" data-options="editable:false,panelHeight:'auto',valueField:'ser_att',textField:'label', data:[{label: 'PS',ser_att: 'PS'},{label: 'SS',ser_att:'SS'},{label: 'GW',ser_att:'GW'}],
                onSelect:function(rec){
                    var ser_srv = $('#ser_srv').combobox('getValue')
                    var url = '/add_combobox_json/?ser_att='+rec.ser_att+'&ser_srv='+ser_srv
                    $('#ser_cfg').combobox('reload',url)
                }
                "></p>
            <p><label for="ser_cfg">配置名:</label>
                <input id='ser_cfg' name="ser_cfg" class="easyui-combobox" style="width:200px;height:32px" required="true" data-options="editable:false,panelHeight:'116',valueField:'cfg',textField:'cfg',url:'/add_combobox_json/',
                onSelect:function(rec){
                    var ser_srv = $('#ser_srv').combobox('getValue')
                    var ser_att = $('#ser_att').combobox('getValue')
                    var ser_cfg = rec.cfg
                    console.log(ser_srv)
                    console.log(ser_att)
                    console.log(ser_cfg)
                    $.ajax({
                        type: 'GET',
                        cache: false,
                        url: '/combobox_port_json/',
                        data: {ser_srv,ser_cfg,ser_att},
                        dataType: 'json',
                        success:function (msg) {
                            console.log(msg[0].port)
                            $('#ser_port').textbox('setValue',msg[0].port)
                        }
                    })
                }"></p>
            <p><label for="ser_port">服务端口:</label>
                <input id="ser_port" name="ser_port" class="easyui-textbox" style="width:200px;height:32px" required="true"></p>
            <p><label for="desc">备注:</label>
                <input name="desc" class="easyui-textbox easyui-validatebox" validType="strChinese" style="width:200px;height:32px" required="true"></p>
            <div style="text-align: center">
                <a id="add" type="submit" style="margin:0 20px" class="easyui-linkbutton" iconCls="icon-save" onclick="service_add()">提交</a>
                <a id="modify" type="submit" style="margin:0 20px" class="easyui-linkbutton" iconCls="icon-save" onclick="service_mod()">修改</a>
                <a style="margin:0 20px" class="easyui-linkbutton" iconCls="icon-cancel" onclick="$('#service').dialog('close')">取消</a>
            </div>
        </form>
    </div>
</body>

</html>
